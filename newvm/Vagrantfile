# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|
  config.vm.box = "hashicorp/bionic64"

  # Forward port 8080 on the guest to port 8080 on the host
  config.vm.network "forwarded_port", guest: 8080, host: 8080

  # Provisioning script to install Java and Jenkins
  config.vm.provision "shell", inline: <<-SHELL
    # Update package list
    apt-get update

    # Install Java
    apt-get install -y openjdk-11-jdk

    # Add Jenkins repository and key
    wget -q -O - https://pkg.jenkins.io/debian/jenkins.io.key | apt-key add -
    echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list

    # Update package list again and install Jenkins
    apt-get update
    apt-get install -y jenkins

    # Start Jenkins service
    systemctl start jenkins
    systemctl enable jenkins
  SHELL
end